<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kagi Translation Extension - Configuration Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 900px;
            margin: 50px auto;
            padding: 20px;
            line-height: 1.6;
        }
        .header {
            background: #f4f4f4;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .section {
            background: #e8f4f8;
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid #2196F3;
            margin-bottom: 20px;
        }
        .test-step {
            margin: 15px 0;
            padding: 10px;
            background: #fff3cd;
            border-radius: 5px;
            border-left: 4px solid #ffc107;
        }
        .expected {
            background: #d4edda;
            border-left: 4px solid #28a745;
        }
        .feature-list {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
        }
        .feature-list ul {
            margin: 0;
        }
        code {
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: Monaco, monospace;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üåç Kagi Translation Extension - Configuration Testing</h1>
        <p>This page is designed to test the new dynamic language configuration features.</p>
    </div>

    <div class="section">
        <h2>‚ú® New Features Added</h2>
        <div class="feature-list">
            <ul>
                <li><strong>Language Selection:</strong> Choose up to 5 preferred languages from 100+ options</li>
                <li><strong>Dynamic Popup:</strong> Translate buttons generated based on selected languages</li>
                <li><strong>Settings Page:</strong> Full-featured options page with search and preview</li>
                <li><strong>Storage Sync:</strong> Settings synchronized across browser instances</li>
                <li><strong>Fallback Support:</strong> Default to Polish if no languages selected</li>
                <li><strong>Flag Icons:</strong> Visual language flags for easy identification</li>
            </ul>
        </div>
    </div>

    <div class="section">
        <h2>üß™ Testing Instructions</h2>

        <div class="test-step">
            <h3>Step 1: First Time Setup</h3>
            <ol>
                <li>Install/reload the extension in Safari or Chrome</li>
                <li>Click the extension icon in the toolbar</li>
                <li>You should see a single "Translate to Polish" button (default)</li>
                <li>Click the "‚öôÔ∏è Settings" button at the bottom</li>
            </ol>
        </div>

        <div class="test-step">
            <h3>Step 2: Configure Languages</h3>
            <ol>
                <li>The options page should open in a new tab</li>
                <li>You'll see 100+ languages in a searchable grid</li>
                <li>Polish should already be selected by default</li>
                <li>Try adding 4 more languages (e.g., Spanish, French, German, Japanese)</li>
                <li>Use the search box to find specific languages</li>
                <li>Watch the selection counter: "Selected Languages (X/5)"</li>
                <li>Try to add a 6th language - it should be disabled</li>
                <li>Click "üíæ Save Settings"</li>
            </ol>
        </div>

        <div class="test-step">
            <h3>Step 3: Test Dynamic Popup</h3>
            <ol>
                <li>Go back to this test page</li>
                <li>Click the extension icon again</li>
                <li>You should now see 5 translate buttons with flags and language names</li>
                <li>Each button should show: "üè≥Ô∏è Translate to [Language Name]"</li>
                <li>Try clicking one of the buttons</li>
            </ol>
        </div>

        <div class="test-step">
            <h3>Step 4: Test Search Functionality</h3>
            <ol>
                <li>Go back to Settings</li>
                <li>Try searching for "chinese" - should show multiple Chinese variants</li>
                <li>Try searching by language code like "es" for Spanish</li>
                <li>Try searching by native name like "Êó•Êú¨Ë™û" for Japanese</li>
                <li>Clear search and verify all languages return</li>
            </ol>
        </div>

        <div class="test-step">
            <h3>Step 5: Test Preview</h3>
            <ol>
                <li>In Settings, watch the "Preview" section</li>
                <li>It should show exactly what your popup will look like</li>
                <li>Add/remove languages and see the preview update</li>
            </ol>
        </div>

        <div class="test-step">
            <h3>Step 6: Test Reset Function</h3>
            <ol>
                <li>Click "üîÑ Reset to Default"</li>
                <li>Confirm the reset</li>
                <li>Should return to just Polish selected</li>
                <li>Save settings and test popup again</li>
            </ol>
        </div>

        <div class="test-step">
            <h3>Step 7: Test Direct Toolbar Click</h3>
            <ol>
                <li>With multiple languages configured</li>
                <li>Try clicking the toolbar icon directly (not the popup)</li>
                <li>Should translate using the first selected language</li>
            </ol>
        </div>

        <div class="test-step">
            <h3>Step 8: Test Kagi Domain Protection</h3>
            <ol>
                <li>Navigate to <code>https://translate.kagi.com</code></li>
                <li>Click the extension icon</li>
                <li>Should show warning message: "Extension Disabled"</li>
                <li>Message should explain it cannot be used on Kagi Translate pages</li>
                <li>Settings button should still be available</li>
                <li>Try clicking toolbar icon directly - should do nothing</li>
            </ol>
        </div>
    </div>

    <div class="section expected">
        <h2>‚úÖ Expected Results</h2>
        <ul>
            <li><strong>Settings Page:</strong> Clean, responsive interface with language grid</li>
            <li><strong>Language Selection:</strong> Max 5 languages, visual feedback when limit reached</li>
            <li><strong>Search:</strong> Real-time filtering by name, native name, or code</li>
            <li><strong>Popup:</strong> Dynamic buttons based on selected languages</li>
            <li><strong>Translation URLs:</strong> <code>https://translate.kagi.com/translate/{code}/{encoded-url}</code></li>
            <li><strong>Storage:</strong> Settings persist between browser sessions</li>
            <li><strong>Fallback:</strong> Works even if no languages selected (defaults to Polish)</li>
            <li><strong>Domain Protection:</strong> Extension disabled on translate.kagi.com with clear warning message</li>
            <li><strong>Auto-Close:</strong> Settings page closes automatically 1.5 seconds after saving</li>
        </ul>
    </div>

    <div class="section">
        <h2>üîß Technical Details</h2>
        <ul>
            <li><strong>Storage API:</strong> <code>browser.storage.sync</code> for cross-device sync</li>
            <li><strong>Languages:</strong> 117 languages included, filtered to 100 unique</li>
            <li><strong>Permissions:</strong> Added <code>storage</code> permission</li>
            <li><strong>Options Page:</strong> Accessible via extension action menu</li>
            <li><strong>Background Script:</strong> Handles direct toolbar clicks</li>
            <li><strong>Popup:</strong> Dynamically generated based on user preferences</li>
        </ul>
    </div>

    <div class="section">
        <h2>üåç Sample Translation URLs</h2>
        <p><strong>Current page URL:</strong> <span id="current-url"></span></p>
        <div id="sample-urls"></div>
    </div>

    <script>
        // Display current URL and sample translation URLs
        const currentUrl = window.location.href;
        document.getElementById('current-url').textContent = currentUrl;
        
        const sampleUrls = document.getElementById('sample-urls');
        const languages = [
            { code: 'pl', name: 'Polish' },
            { code: 'es', name: 'Spanish' },
            { code: 'fr', name: 'French' },
            { code: 'de', name: 'German' },
            { code: 'ja', name: 'Japanese' }
        ];
        
        languages.forEach(lang => {
            const url = `https://translate.kagi.com/translate/${lang.code}/` + encodeURIComponent(currentUrl);
            const div = document.createElement('div');
            div.innerHTML = `<strong>${lang.name}:</strong> <code>${url}</code>`;
            div.style.marginBottom = '8px';
            sampleUrls.appendChild(div);
        });
        
        console.log('Configuration test page loaded');
        console.log('Current URL:', currentUrl);
    </script>
</body>
</html>
